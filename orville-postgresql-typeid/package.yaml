---
name: orville-postgresql-typeid
version: '0.1.0.0'
synopsis: An additional orville package for type ids
description:
  Provides support in orville for https://github.com/jetify-com/typeid
  using functions from https://github.com/jetify-com/typeid-sql
category: database, library, postgresql
author: Flipstone Technology Partners
maintainer: maintainers@flipstone.com
license: Apache-2.0
license-file: LICENSE
git: git@github.com:flipstone/orville.git
tested-with: GHC == 9.8.4, GHC == 9.10.2, GHC == 9.12.2

flags:
  ci:
    description: More strict ghc options used for development and ci, not intended for end-use.
    manual: true
    default: false

library:
  source-dirs: src
  exposed-modules:
    - Orville.TypeId.FunctionDefinitions
    - Orville.TypeId.FieldDefinition

  when:
    - condition: flag(ci)
      ghc-options:
        - -Wall
        - -Werror
        - -Wcompat
        - -Widentities
        - -Wincomplete-uni-patterns
        - -Wincomplete-patterns
        - -Wincomplete-record-updates
        - -Wmissing-local-signatures
        - -Wmissing-export-lists
        - -Wmissing-import-lists
        - -Wmonomorphism-restriction
        - -Wnoncanonical-monad-instances
        - -Wpartial-fields
        - -Wredundant-constraints
        - -Wmissed-specialisations
        - -Wno-implicit-prelude
        - -Wno-safe
        - -Wno-unsafe
      when:
        - condition: impl (ghc >= 9.2)
          ghc-options:
            - -Woperator-whitespace
            - -Wredundant-bang-patterns
        - condition: impl (ghc >= 9.4)
          ghc-options:
            - -Wredundant-strictness-flags

        - condition: impl (ghc >= 9.8)
          ghc-options:
            - -Wterm-variable-capture

  dependencies:
    - base >=4.8 && <5
    - bytestring >= 0.10 && < 0.13
    - mmzk-typeid >= 0.7 && <8
    - orville-postgresql >= 1.1.0.0.5 && <2
    - postgresql-libpq >= 0.9.4.2 && <0.12
    - raw-strings-qq >= 1.1 && <1.2
    - text (>= 1.2 && < 1.3) || (>=2.0 && <2.2)
    - uuid >= 1.3.15 && <1.4

tests:
  spec:
    source-dirs: test
    main: Main.hs
    dependencies:
      - base >=4.8 && <5
      - bytestring >=0.10 && <0.13
      - hedgehog >= 1.0.5 && <1.7
      - mmzk-typeid >= 0.7 && <8
      - orville-postgresql >= 1.1.0.0.5 && <2
      - orville-postgresql-typeid
      - postgresql-libpq >= 0.9.4.2 && <0.12
      - raw-strings-qq >= 1.1 && <1.2
      - text (>= 1.2 && < 1.3) || (>=2.0 && <2.2)
      - uuid >= 1.3.15 && <1.4
    when:
      - condition: flag(ci)
        ghc-options:
          - -j
          - -Wall
          - -Werror
          - -Wcompat
          - -Widentities
          - -Wincomplete-uni-patterns
          - -Wincomplete-record-updates
          - -Wmissing-local-signatures
          - -Wmissing-export-lists
          - -Wno-implicit-prelude
          - -Wno-safe
          - -Wno-unsafe
          - -Wnoncanonical-monad-instances
          - -Wredundant-constraints
          - -Wpartial-fields
          - -Wmissed-specialisations
          - -Woverflowed-literals
