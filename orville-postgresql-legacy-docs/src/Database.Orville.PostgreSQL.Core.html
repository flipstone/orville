<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module    : Database.Orville.PostgreSQL.Core
Copyright : Flipstone Technology Partners 2016-2018
License   : MIT

Migration Guide: Although not all exports are identical, most of the items in
this module can now be imported from @Orville.PostgreSQL@.

Please note that the new LibPQ-based version of orville represents a complete
re-write of Orville from the ground up. As such many of the APIs have been
re-thought with the goal of providing stability and better experience long
term.

Major changes:

* The library no longer allows the connection type to vary. It is intended only
  to be used with PostgreSQL. Thus 'MonadOrville' and other types that used to
  have a @conn@ type parameter no longer have that parameter.

* 'OrvilleT' has been removed in favor of simply using @ReaderT@. For trivial
  cases (i.e. @ReaderT@ over @IO@) a pre-packaged @Orville@ monad is provided.

* In 'TableDefinition', the order of the type parameters has changed from
  @TableDefinition readEnity writeEntity key@ to @TableDefinition key
  writeEntity readEntity@. This make it more consistent with the order of these
  arguments in other types. 'TableParams' has been removed in favor of building
  a basic table definition with the require parameters first and adding or
  setting other optional items after initial construction.

* 'RelationalMap' has been replaced by @SqlMarshaller@. Many functions have
  been renamed, but most functions have a direct or nearly direct translation
  from the old ones. See the docs on the individual functions such as
  'attrField' to see what has changed.

* The auto-migration system is significantly improved. Standard indexes no
  longer need to be given explicit names. Indexes and constraints are now
  attached to 'TableDefinition' rather than being their own schema items.
  Indexes and constraints are no longer dropped explicitly -- they are dropped
  automatically by Orville when they have been removed from the table
  definiton.

* A number of places that previously accepted @[]@ now require @NonEmpty@
  instead. This is done in places where an empty list would not be valid SQL.
  For examples of this change see 'insertRecordMany' and 'updateFields'.

* 'whereAnd' and 'whereOr' (which took lists) have been replaced
  with binary boolean logic functions @andExpr@ and @orExpr@. These functions
  also have operator aliases (@(.&amp;&amp;)@, @(.||)@).

The following items exported from this module have migration guide notes
available in their documentation:

* 'TableDefinition'
* 'mkTableDefinition'
* 'TableParams'
* 'RelationalMap'
* 'fields'
* 'mapAttr'
* 'mapField'
* 'attrField'
* 'maybeMapper'
* 'prefixMap'
* 'partialMap'
* 'readOnlyMap'
* 'readOnlyField'
* 'OrvilleEnv'
* 'newOrvilleEnv'
* 'setStartTransactionSQL'
* 'aroundRunningQuery'
* 'addTransactionCallBack'
* 'OrvilleT'
* 'HasOrvilleContext'
* 'MonadOrville'
* 'runOrville'
* 'mapOrvilleT'
* 'MonadOrvilleControl'
* 'defaultLiftWithConnection'
* 'defaultLiftFinally'
* 'withCachedConnection'
* 'withTransaction'
* 'ColumnFlag'
* 'FieldDefinition'
* 'isFieldNullable'
* 'fieldOfType'
* 'textField'
* 'fixedTextField'
* 'unboundedTextField'
* 'dayField'
* 'utcTimeField'
* 'int32Field'
* 'int64Field'
* 'doubleField'
* 'boolField'
* 'automaticIdField'
* 'searchVectorField'
* 'nullableField'
* 'foreignKeyField'
* 'withFlag'
* 'withName'
* 'withConversion'
* 'fieldFromSql'
* 'fieldToSqlValue'
* 'SomeField'
* 'withPrefix'
* 'fieldFlags'
* 'uniqueIndex'
* 'simpleIndex'
* 'uniqueConstraint'
* 'dropConstraint'
* 'SchemaItem'
* 'SchemaDefinition'
* 'Record'
* 'WhereCondition'
* 'whereAnd'
* 'whereOr'
* 'whereIn'
* 'whereLike'
* 'whereLikeInsensitive'
* 'whereNotIn'
* 'whereQualified'
* 'whereRaw'
* 'whereToSql'
* 'isNull'
* 'isNotNull'
* 'migrateSchema'
* 'generateMigrationPlan'
* 'MigrationPlan'
* 'MigrationItem'
* 'migrationPlanItems'
* 'selectAll'
* 'selectFirst'
* 'deleteRecord'
* 'deleteWhere'
* 'findRecord'
* 'findRecords'
* 'findRecordsBy'
* 'insertRecord'
* 'insertRecordMany'
* 'insertRecordManyReturning'
* 'updateFields'
* 'updateRecord'
* 'createIndexesConcurrently'
* 'dropIndexesConcurrently'

-}</span><span>
</span><a name="line-146"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Orville.PostgreSQL.Core</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a><span>
</span><a name="line-151"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyIn"><span class="hs-identifier hs-var">primaryKeyIn</span></a><span>
</span><a name="line-152"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-var">primaryKeyEquals</span></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyDescription"><span class="hs-identifier hs-var">primaryKeyDescription</span></a><span>
</span><a name="line-154"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyToSql"><span class="hs-identifier hs-var">primaryKeyToSql</span></a><span>
</span><a name="line-155"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKey"><span class="hs-identifier hs-var">primaryKey</span></a><span>
</span><a name="line-156"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#compositePrimaryKey"><span class="hs-identifier hs-var">compositePrimaryKey</span></a><span>
</span><a name="line-157"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyPart"><span class="hs-identifier hs-var">primaryKeyPart</span></a><span>
</span><a name="line-158"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#mkTableDefinition"><span class="hs-identifier hs-var">mkTableDefinition</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#SqlType"><span class="hs-identifier hs-type">SqlType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#serial"><span class="hs-identifier hs-var">serial</span></a><span>
</span><a name="line-161"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#bigserial"><span class="hs-identifier hs-var">bigserial</span></a><span>
</span><a name="line-162"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#text"><span class="hs-identifier hs-var">text</span></a><span>
</span><a name="line-163"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#varText"><span class="hs-identifier hs-var">varText</span></a><span>
</span><a name="line-164"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#unboundedText"><span class="hs-identifier hs-var">unboundedText</span></a><span>
</span><a name="line-165"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#integer"><span class="hs-identifier hs-var">integer</span></a><span>
</span><a name="line-166"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#bigInteger"><span class="hs-identifier hs-var">bigInteger</span></a><span>
</span><a name="line-167"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#double"><span class="hs-identifier hs-var">double</span></a><span>
</span><a name="line-168"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#boolean"><span class="hs-identifier hs-var">boolean</span></a><span>
</span><a name="line-169"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#date"><span class="hs-identifier hs-var">date</span></a><span>
</span><a name="line-170"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#timestamp"><span class="hs-identifier hs-var">timestamp</span></a><span>
</span><a name="line-171"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#textSearchVector"><span class="hs-identifier hs-var">textSearchVector</span></a><span>
</span><a name="line-172"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#convertSqlType"><span class="hs-identifier hs-var">convertSqlType</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-173"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#maybeConvertSqlType"><span class="hs-identifier hs-var">maybeConvertSqlType</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-174"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#TableParams"><span class="hs-identifier hs-type">TableParams</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#RelationalMap"><span class="hs-identifier hs-type">RelationalMap</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#fields"><span class="hs-identifier hs-var">fields</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#mapAttr"><span class="hs-identifier hs-var">mapAttr</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#mapField"><span class="hs-identifier hs-var">mapField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#attrField"><span class="hs-identifier hs-var">attrField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-180"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#maybeMapper"><span class="hs-identifier hs-var">maybeMapper</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-181"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#prefixMap"><span class="hs-identifier hs-var">prefixMap</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-182"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#partialMap"><span class="hs-identifier hs-var">partialMap</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#readOnlyMap"><span class="hs-identifier hs-var">readOnlyMap</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-184"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html#readOnlyField"><span class="hs-identifier hs-var">readOnlyField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-185"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleEnv"><span class="hs-identifier hs-type">OrvilleEnv</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-186"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#newOrvilleEnv"><span class="hs-identifier hs-var">newOrvilleEnv</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-187"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#setStartTransactionSQL"><span class="hs-identifier hs-var">setStartTransactionSQL</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-188"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#aroundRunningQuery"><span class="hs-identifier hs-var">aroundRunningQuery</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-189"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#addTransactionCallBack"><span class="hs-identifier hs-var">addTransactionCallBack</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-190"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#ormEnvPool"><span class="hs-identifier hs-var">ormEnvPool</span></a><span>
</span><a name="line-191"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#TransactionEvent"><span class="hs-identifier hs-type">TransactionEvent</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-192"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">OrvilleT</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-193"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#unOrvilleT"><span class="hs-identifier hs-var">unOrvilleT</span></a><span>
</span><a name="line-194"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SqlValue</span><span>
</span><a name="line-195"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#HasOrvilleContext"><span class="hs-identifier hs-type">HasOrvilleContext</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-196"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#runOrville"><span class="hs-identifier hs-var">runOrville</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#mapOrvilleT"><span class="hs-identifier hs-var">mapOrvilleT</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-199"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrvilleControl"><span class="hs-identifier hs-type">MonadOrvilleControl</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-200"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#defaultLiftWithConnection"><span class="hs-identifier hs-var">defaultLiftWithConnection</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-201"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#defaultLiftFinally"><span class="hs-identifier hs-var">defaultLiftFinally</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-202"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#QueryType"><span class="hs-identifier hs-type">QueryType</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Raw.html#withCachedConnection"><span class="hs-identifier hs-var">withCachedConnection</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-204"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Raw.html#withTransaction"><span class="hs-identifier hs-var">withTransaction</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-205"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#ColumnFlag"><span class="hs-identifier hs-type">ColumnFlag</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-206"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#ColumnDefault"><span class="hs-identifier hs-type">ColumnDefault</span></a><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Types.html#toColumnDefaultSql"><span class="hs-identifier hs-var">toColumnDefaultSql</span></a><span class="hs-special">)</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#Now"><span class="hs-identifier hs-type">Now</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-209"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#Nullable"><span class="hs-identifier hs-type">Nullable</span></a><span>
</span><a name="line-210"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a><span>
</span><a name="line-211"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#Nullability"><span class="hs-identifier hs-type">Nullability</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#isFieldNullable"><span class="hs-identifier hs-var">isFieldNullable</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-213"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#fieldOfType"><span class="hs-identifier hs-var">fieldOfType</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#textField"><span class="hs-identifier hs-var">textField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#fixedTextField"><span class="hs-identifier hs-var">fixedTextField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#unboundedTextField"><span class="hs-identifier hs-var">unboundedTextField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#dayField"><span class="hs-identifier hs-var">dayField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-218"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#utcTimeField"><span class="hs-identifier hs-var">utcTimeField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#int32Field"><span class="hs-identifier hs-var">int32Field</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#int64Field"><span class="hs-identifier hs-var">int64Field</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#doubleField"><span class="hs-identifier hs-var">doubleField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#boolField"><span class="hs-identifier hs-var">boolField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-223"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#automaticIdField"><span class="hs-identifier hs-var">automaticIdField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-224"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#searchVectorField"><span class="hs-identifier hs-var">searchVectorField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-225"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#nullableField"><span class="hs-identifier hs-var">nullableField</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-226"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#foreignKeyField"><span class="hs-identifier hs-var">foreignKeyField</span></a><span> </span><span class="hs-comment">-- migration guided added</span><span>
</span><a name="line-227"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#withFlag"><span class="hs-identifier hs-var">withFlag</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#withName"><span class="hs-identifier hs-var">withName</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-229"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#withConversion"><span class="hs-identifier hs-var">withConversion</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-230"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#fieldFromSql"><span class="hs-identifier hs-var">fieldFromSql</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#fieldToSqlValue"><span class="hs-identifier hs-var">fieldToSqlValue</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SomeField"><span class="hs-identifier hs-type">SomeField</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#withPrefix"><span class="hs-identifier hs-var">withPrefix</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a><span>
</span><a name="line-235"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#fieldType"><span class="hs-identifier hs-var">fieldType</span></a><span>
</span><a name="line-236"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#fieldFlags"><span class="hs-identifier hs-var">fieldFlags</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-237"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#IndexDefinition"><span class="hs-identifier hs-type">IndexDefinition</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.IndexDefinition.html#uniqueIndex"><span class="hs-identifier hs-var">uniqueIndex</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.IndexDefinition.html#simpleIndex"><span class="hs-identifier hs-var">simpleIndex</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.IndexDefinition.html#simplePartialIndex"><span class="hs-identifier hs-var">simplePartialIndex</span></a><span>
</span><a name="line-241"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.IndexDefinition.html#uniquePartialIndex"><span class="hs-identifier hs-var">uniquePartialIndex</span></a><span>
</span><a name="line-242"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#ConstraintDefinition"><span class="hs-identifier hs-type">ConstraintDefinition</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SequenceDefinition"><span class="hs-identifier hs-type">SequenceDefinition</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.ConstraintDefinition.html#uniqueConstraint"><span class="hs-identifier hs-var">uniqueConstraint</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-245"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.ConstraintDefinition.html#dropConstraint"><span class="hs-identifier hs-var">dropConstraint</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-246"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FromSql"><span class="hs-identifier hs-type">FromSql</span></a><span>
</span><a name="line-247"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FromSqlError"><span class="hs-identifier hs-type">FromSqlError</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#RowDataErrorDetails"><span class="hs-identifier hs-type">RowDataErrorDetails</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#RowDataErrorReason"><span class="hs-identifier hs-type">RowDataErrorReason</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#MissingColumnDetails"><span class="hs-identifier hs-type">MissingColumnDetails</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#ConversionErrorDetails"><span class="hs-identifier hs-type">ConversionErrorDetails</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#showFromSqlErrorMinimal"><span class="hs-identifier hs-var">showFromSqlErrorMinimal</span></a><span>
</span><a name="line-253"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#showFromSqlErrorForLogging"><span class="hs-identifier hs-var">showFromSqlErrorForLogging</span></a><span>
</span><a name="line-254"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html#showSqlValueType"><span class="hs-identifier hs-var">showSqlValueType</span></a><span>
</span><a name="line-255"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#ColumnSpecifier"><span class="hs-identifier hs-type">ColumnSpecifier</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#col"><span class="hs-identifier hs-var">col</span></a><span>
</span><a name="line-257"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span>
</span><a name="line-258"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#getField"><span class="hs-identifier hs-var">getField</span></a><span>
</span><a name="line-259"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#getComponent"><span class="hs-identifier hs-var">getComponent</span></a><span>
</span><a name="line-260"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SchemaItem"><span class="hs-identifier hs-type">SchemaItem</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-261"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SchemaDefinition"><span class="hs-identifier hs-type">SchemaDefinition</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-262"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#Record"><span class="hs-identifier hs-type">Record</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-263"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#CreatedAt"><span class="hs-identifier hs-type">CreatedAt</span></a><span>
</span><a name="line-264"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#UpdatedAt"><span class="hs-identifier hs-type">UpdatedAt</span></a><span>
</span><a name="line-265"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#OccurredAt"><span class="hs-identifier hs-type">OccurredAt</span></a><span>
</span><a name="line-266"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableComments"><span class="hs-identifier hs-type">TableComments</span></a><span>
</span><a name="line-267"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#noComments"><span class="hs-identifier hs-var">noComments</span></a><span>
</span><a name="line-268"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#say"><span class="hs-identifier hs-var">say</span></a><span>
</span><a name="line-269"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#WhereCondition"><span class="hs-identifier hs-type">WhereCondition</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-270"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereAnd"><span class="hs-identifier hs-var">whereAnd</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-271"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereOr"><span class="hs-identifier hs-var">whereOr</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereIn"><span class="hs-identifier hs-var">whereIn</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-273"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereLike"><span class="hs-identifier hs-var">whereLike</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-274"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereLikeInsensitive"><span class="hs-identifier hs-var">whereLikeInsensitive</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereNotIn"><span class="hs-identifier hs-var">whereNotIn</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereQualified"><span class="hs-identifier hs-var">whereQualified</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereRaw"><span class="hs-identifier hs-var">whereRaw</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereToSql"><span class="hs-identifier hs-var">whereToSql</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#isNull"><span class="hs-identifier hs-var">isNull</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#isNotNull"><span class="hs-identifier hs-var">isNotNull</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3D%3D"><span class="hs-operator hs-var">.==</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3C%3E"><span class="hs-operator hs-var">.&lt;&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3C-"><span class="hs-operator hs-var">.&lt;-</span></a><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#%25%3D%3D"><span class="hs-operator hs-var">%==</span></a><span class="hs-special">)</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3E"><span class="hs-operator hs-var">.&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3E%3D"><span class="hs-operator hs-var">.&gt;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3C"><span class="hs-operator hs-var">.&lt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#.%3C%3D"><span class="hs-operator hs-var">.&lt;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#SelectOptions"><span class="hs-identifier hs-type">SelectOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#where_"><span class="hs-identifier hs-var">where_</span></a><span>
</span><a name="line-291"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#distinct"><span class="hs-identifier hs-var">distinct</span></a><span>
</span><a name="line-292"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#order"><span class="hs-identifier hs-var">order</span></a><span>
</span><a name="line-293"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#limit"><span class="hs-identifier hs-var">limit</span></a><span>
</span><a name="line-294"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#offset"><span class="hs-identifier hs-var">offset</span></a><span>
</span><a name="line-295"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a><span>
</span><a name="line-296"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#selectOptionsToSql"><span class="hs-identifier hs-var">selectOptionsToSql</span></a><span>
</span><a name="line-297"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span>
</span><a name="line-299"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldUpdate.html#fieldUpdate"><span class="hs-identifier hs-var">fieldUpdate</span></a><span>
</span><a name="line-300"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.FieldUpdate.html#.%3A%3D"><span class="hs-operator hs-var">.:=</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.OrderBy.html#OrderByClause"><span class="hs-identifier hs-type">OrderByClause</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-302"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.OrderBy.html#SortDirection"><span class="hs-identifier hs-type">SortDirection</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrateSchema.html#migrateSchema"><span class="hs-identifier hs-var">migrateSchema</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-304"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrationError.html#MigrationError"><span class="hs-identifier hs-type">MigrationError</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrateSchema.html#generateMigrationPlan"><span class="hs-identifier hs-var">generateMigrationPlan</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrationPlan.html#MigrationPlan"><span class="hs-identifier hs-type">MigrationPlan</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrationPlan.html#MigrationItem"><span class="hs-identifier hs-type">MigrationItem</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrationPlan.html#migrationPlanItems"><span class="hs-identifier hs-var">migrationPlanItems</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-309"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Pagination.html#Pagination"><span class="hs-identifier hs-type">Pagination</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Pagination.html#buildPagination"><span class="hs-identifier hs-var">buildPagination</span></a><span>
</span><a name="line-311"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#selectAll"><span class="hs-identifier hs-var">selectAll</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#selectFirst"><span class="hs-identifier hs-var">selectFirst</span></a><span> </span><span class="hs-comment">-- migraiton guide added</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#deleteRecord"><span class="hs-identifier hs-var">deleteRecord</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#deleteWhere"><span class="hs-identifier hs-var">deleteWhere</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#findRecord"><span class="hs-identifier hs-var">findRecord</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#findRecords"><span class="hs-identifier hs-var">findRecords</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-317"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#findRecordsBy"><span class="hs-identifier hs-var">findRecordsBy</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-318"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#insertRecord"><span class="hs-identifier hs-var">insertRecord</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#insertRecordMany"><span class="hs-identifier hs-var">insertRecordMany</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-320"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#insertRecordManyReturning"><span class="hs-identifier hs-var">insertRecordManyReturning</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-321"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#updateFields"><span class="hs-identifier hs-var">updateFields</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-322"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#updateRecord"><span class="hs-identifier hs-var">updateRecord</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-323"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#sequenceNextVal"><span class="hs-identifier hs-var">sequenceNextVal</span></a><span>
</span><a name="line-324"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#sequenceSetVal"><span class="hs-identifier hs-var">sequenceSetVal</span></a><span>
</span><a name="line-325"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#sequenceCurrVal"><span class="hs-identifier hs-var">sequenceCurrVal</span></a><span>
</span><a name="line-326"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrateSchema.html#createIndexesConcurrently"><span class="hs-identifier hs-var">createIndexesConcurrently</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-327"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrateSchema.html#dropIndexesConcurrently"><span class="hs-identifier hs-var">dropIndexesConcurrently</span></a><span> </span><span class="hs-comment">-- migration guide added</span><span>
</span><a name="line-328"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">when</span><span class="hs-special">)</span><span>
</span><a name="line-331"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Except</span><span>
</span><a name="line-332"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Reader</span><span>
</span><a name="line-333"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span>
</span><a name="line-334"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Convertible</span><span>
</span><a name="line-335"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-336"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map.Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-337"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-338"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database.HDBC</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">withTransaction</span><span class="hs-special">)</span><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MappendCompat.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.MappendCompat</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Map.Helpers.html"><span class="hs-identifier">Data.Map.Helpers</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-343"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.ConstraintDefinition.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.ConstraintDefinition</span></a><span>
</span><a name="line-344"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Execute.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Execute</span></a><span>
</span><a name="line-345"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Expr.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Expr</span></a><span>
</span><a name="line-346"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.FieldDefinition</span></a><span>
</span><a name="line-347"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldUpdate.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.FieldUpdate</span></a><span>
</span><a name="line-348"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.FromSql</span></a><span>
</span><a name="line-349"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.GroupBy.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.GroupBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.IndexDefinition.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.IndexDefinition</span></a><span>
</span><a name="line-351"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrateSchema.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.MigrateSchema</span></a><span>
</span><a name="line-352"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrationError.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.MigrationError</span></a><span>
</span><a name="line-353"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.MigrationPlan.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.MigrationPlan</span></a><span>
</span><a name="line-354"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Monad</span></a><span>
</span><a name="line-355"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.OrderBy.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.OrderBy</span></a><span>
</span><a name="line-356"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.PrimaryKey</span></a><span>
</span><a name="line-357"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.RelationalMap.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.RelationalMap</span></a><span>
</span><a name="line-358"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.SelectOptions</span></a><span>
</span><a name="line-359"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Sql.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Sql</span></a><span>
</span><a name="line-360"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SqlType.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.SqlType</span></a><span>
</span><a name="line-361"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.TableDefinition.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.TableDefinition</span></a><span>
</span><a name="line-362"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Types</span></a><span>
</span><a name="line-363"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Where</span></a><span>
</span><a name="line-364"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Pagination.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Pagination</span></a><span>
</span><a name="line-365"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Raw.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Raw</span></a><span>
</span><a name="line-366"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Orville.PostgreSQL.Select.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Select</span></a><span>
</span><a name="line-367"></a><span>
</span><a name="line-368"></a><span class="hs-identifier">getField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Convertible</span><span> </span><a href="#local-6989586621679133413"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">SqlValue</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679133414"><span class="hs-identifier hs-type">entity</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133413"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#ToSql"><span class="hs-identifier hs-type">ToSql</span></a><span> </span><a href="#local-6989586621679133414"><span class="hs-identifier hs-type">entity</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-369"></a><a name="getField"><a href="Database.Orville.PostgreSQL.Core.html#getField"><span class="hs-identifier">getField</span></a></a><span> </span><a name="local-6989586621679133415"><a href="#local-6989586621679133415"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-370"></a><span>  </span><a name="local-6989586621679133416"><a href="#local-6989586621679133416"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">asks</span><span> </span><a href="#local-6989586621679133415"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-371"></a><span>  </span><a name="local-6989586621679133417"><a href="#local-6989586621679133417"><span class="hs-identifier">sqlValues</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-372"></a><span>  </span><span class="hs-identifier hs-var">put</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">convert</span><span> </span><a href="#local-6989586621679133416"><span class="hs-identifier hs-var">value</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679133417"><span class="hs-identifier hs-var">sqlValues</span></a><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-comment">{- |
  Migration Guide: @selectAll@ has been renamed to @findEntitiesBy@
-}</span><span>
</span><a name="line-377"></a><span class="hs-identifier">selectAll</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-378"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133408"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133409"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-379"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133410"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133411"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133412"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-380"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#SelectOptions"><span class="hs-identifier hs-type">SelectOptions</span></a><span>
</span><a name="line-381"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133409"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133410"><span class="hs-identifier hs-type">readEntity</span></a><span class="hs-special">]</span><span>
</span><a name="line-382"></a><a name="selectAll"><a href="Database.Orville.PostgreSQL.Core.html#selectAll"><span class="hs-identifier">selectAll</span></a></a><span> </span><a name="local-6989586621679133418"><a href="#local-6989586621679133418"><span class="hs-identifier">tableDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Select.html#selectQueryTable"><span class="hs-identifier hs-var">selectQueryTable</span></a><span> </span><a href="#local-6989586621679133418"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span>
</span><a name="line-385"></a><span class="hs-comment">{- |
  Migration Guide: @selectFirst@ has been renamed to @findFirstEntityBy@
-}</span><span>
</span><a name="line-388"></a><span class="hs-identifier">selectFirst</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-389"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133403"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133404"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-390"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133405"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133406"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133407"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-391"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#SelectOptions"><span class="hs-identifier hs-type">SelectOptions</span></a><span>
</span><a name="line-392"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133404"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679133405"><span class="hs-identifier hs-type">readEntity</span></a><span class="hs-special">)</span><span>
</span><a name="line-393"></a><a name="selectFirst"><a href="Database.Orville.PostgreSQL.Core.html#selectFirst"><span class="hs-identifier">selectFirst</span></a></a><span> </span><a name="local-6989586621679133419"><a href="#local-6989586621679133419"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133420"><a href="#local-6989586621679133420"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-394"></a><span>  </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#selectAll"><span class="hs-identifier hs-var">selectAll</span></a><span> </span><a href="#local-6989586621679133419"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#limit"><span class="hs-identifier hs-var">limit</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679133420"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-identifier">deleteWhereBuild</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-397"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133398"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133399"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-398"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133400"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133401"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133402"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-399"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#WhereCondition"><span class="hs-identifier hs-type">WhereCondition</span></a><span class="hs-special">]</span><span>
</span><a name="line-400"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133399"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-401"></a><a name="deleteWhereBuild"><a href="Database.Orville.PostgreSQL.Core.html#deleteWhereBuild"><span class="hs-identifier">deleteWhereBuild</span></a></a><span> </span><a name="local-6989586621679133421"><a href="#local-6989586621679133421"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133422"><a href="#local-6989586621679133422"><span class="hs-identifier">conds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-402"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133423"><a href="#local-6989586621679133423"><span class="hs-identifier">deleteSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Sql.html#mkDeleteClause"><span class="hs-identifier hs-var">mkDeleteClause</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tableName</span><span> </span><a href="#local-6989586621679133421"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133424"><a href="#local-6989586621679133424"><span class="hs-identifier">whereSql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereClause"><span class="hs-identifier hs-var">whereClause</span></a><span> </span><a href="#local-6989586621679133422"><span class="hs-identifier hs-var">conds</span></a><span>
</span><a name="line-404"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133425"><a href="#local-6989586621679133425"><span class="hs-identifier">values</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereValues"><span class="hs-identifier hs-var">whereValues</span></a><span> </span><a href="#local-6989586621679133422"><span class="hs-identifier hs-var">conds</span></a><span>
</span><a name="line-405"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133426"><a href="#local-6989586621679133426"><span class="hs-identifier">querySql</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679133423"><span class="hs-identifier hs-var">deleteSql</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679133424"><span class="hs-identifier hs-var">whereSql</span></a><span>
</span><a name="line-406"></a><span>  </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#withConnection"><span class="hs-identifier hs-var">withConnection</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679133427"><a href="#local-6989586621679133427"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-407"></a><span>    </span><a href="Database.Orville.PostgreSQL.Internal.Execute.html#executingSql"><span class="hs-identifier hs-var">executingSql</span></a><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#DeleteQuery"><span class="hs-identifier hs-var">DeleteQuery</span></a><span> </span><a href="#local-6989586621679133426"><span class="hs-identifier hs-var">querySql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">run</span><span> </span><a href="#local-6989586621679133427"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="#local-6989586621679133426"><span class="hs-identifier hs-var">querySql</span></a><span> </span><a href="#local-6989586621679133425"><span class="hs-identifier hs-var">values</span></a><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-comment">{- |
  Migration Guide: @deleteWhere@ has been renamed to @deleteEntities@. It
  now takes a @Maybe BooleanExpr@ rather than @[WhereCondition]@
-}</span><span>
</span><a name="line-413"></a><span class="hs-identifier">deleteWhere</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-414"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133393"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133394"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-415"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133395"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133396"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133397"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-416"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#WhereCondition"><span class="hs-identifier hs-type">WhereCondition</span></a><span class="hs-special">]</span><span>
</span><a name="line-417"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133394"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-418"></a><a name="deleteWhere"><a href="Database.Orville.PostgreSQL.Core.html#deleteWhere"><span class="hs-identifier">deleteWhere</span></a></a><span> </span><a name="local-6989586621679133428"><a href="#local-6989586621679133428"><span class="hs-identifier">tableDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#deleteWhereBuild"><span class="hs-identifier hs-var">deleteWhereBuild</span></a><span> </span><a href="#local-6989586621679133428"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-comment">{- |
  Migration Guide: @findRecords@ has been renamed to @findEntities@. It now
  requires a @NonEmpty key@ rather than simply @[key]@ and returns a
  @[readEntity]@ instead of a @Map@.
-}</span><span>
</span><a name="line-425"></a><span class="hs-identifier">findRecords</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-426"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679133388"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133389"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133390"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133391"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133392"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133388"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-428"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133388"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">]</span><span>
</span><a name="line-429"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133390"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map.Map</span><span> </span><a href="#local-6989586621679133388"><span class="hs-identifier hs-type">key</span></a><span> </span><a href="#local-6989586621679133391"><span class="hs-identifier hs-type">readEntity</span></a><span class="hs-special">)</span><span>
</span><a name="line-430"></a><a name="findRecords"><a href="Database.Orville.PostgreSQL.Core.html#findRecords"><span class="hs-identifier">findRecords</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Map.empty</span><span>
</span><a name="line-431"></a><span class="hs-identifier">findRecords</span><span> </span><a name="local-6989586621679133429"><a href="#local-6989586621679133429"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133430"><a href="#local-6989586621679133430"><span class="hs-identifier">keys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-432"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133431"><a href="#local-6989586621679133431"><span class="hs-identifier">keyDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tablePrimaryKey</span><span> </span><a href="#local-6989586621679133429"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-433"></a><span>      </span><a name="local-6989586621679133432"><a href="#local-6989586621679133432"><span class="hs-identifier">mkEntry</span></a></a><span> </span><a name="local-6989586621679133433"><a href="#local-6989586621679133433"><span class="hs-identifier">record</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">tableGetKey</span><span> </span><a href="#local-6989586621679133429"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><a href="#local-6989586621679133433"><span class="hs-identifier hs-var">record</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679133433"><span class="hs-identifier hs-var">record</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>  </span><a name="local-6989586621679133434"><a href="#local-6989586621679133434"><span class="hs-identifier">recordList</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#selectAll"><span class="hs-identifier hs-var">selectAll</span></a><span> </span><a href="#local-6989586621679133429"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#where_"><span class="hs-identifier hs-var">where_</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyIn"><span class="hs-identifier hs-var">primaryKeyIn</span></a><span> </span><a href="#local-6989586621679133431"><span class="hs-identifier hs-var">keyDef</span></a><span> </span><a href="#local-6989586621679133430"><span class="hs-identifier hs-var">keys</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>  </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679133432"><span class="hs-identifier hs-var">mkEntry</span></a><span> </span><a href="#local-6989586621679133434"><span class="hs-identifier hs-var">recordList</span></a><span class="hs-special">)</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-comment">{- |
  Migration Guide: @findRecordsBy@ has been renamed to @findEntitiesBy@. It
  no longer takes a @FieldDefinition@ to group by. Instead it simply returns
  a @[readEntity]@
-}</span><span>
</span><a name="line-442"></a><span class="hs-identifier">findRecordsBy</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-443"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679133381"><span class="hs-identifier hs-type">fieldValue</span></a><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133382"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133383"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-444"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133384"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133385"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133386"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-445"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a><span> </span><a href="#local-6989586621679133387"><span class="hs-identifier hs-type">nullability</span></a><span> </span><a href="#local-6989586621679133381"><span class="hs-identifier hs-type">fieldValue</span></a><span>
</span><a name="line-446"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#SelectOptions"><span class="hs-identifier hs-type">SelectOptions</span></a><span>
</span><a name="line-447"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133383"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map.Map</span><span> </span><a href="#local-6989586621679133381"><span class="hs-identifier hs-type">fieldValue</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133384"><span class="hs-identifier hs-type">readEntity</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-448"></a><a name="findRecordsBy"><a href="Database.Orville.PostgreSQL.Core.html#findRecordsBy"><span class="hs-identifier">findRecordsBy</span></a></a><span> </span><a name="local-6989586621679133435"><a href="#local-6989586621679133435"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133436"><a href="#local-6989586621679133436"><span class="hs-identifier">field</span></a></a><span> </span><a name="local-6989586621679133437"><a href="#local-6989586621679133437"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-449"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133438"><a href="#local-6989586621679133438"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#fieldFromSql"><span class="hs-identifier hs-var">fieldFromSql</span></a><span> </span><a href="#local-6989586621679133436"><span class="hs-identifier hs-var">field</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier">tableFromSql</span><span> </span><a href="#local-6989586621679133435"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-450"></a><span>      </span><a name="local-6989586621679133439"><a href="#local-6989586621679133439"><span class="hs-identifier">query</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Select.html#selectQuery"><span class="hs-identifier hs-var">selectQuery</span></a><span> </span><a href="#local-6989586621679133438"><span class="hs-identifier hs-var">builder</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.FromClause.html#fromClauseTable"><span class="hs-identifier hs-var">fromClauseTable</span></a><span> </span><a href="#local-6989586621679133435"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679133437"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-451"></a><span>  </span><a href="Data.Map.Helpers.html#groupBy%27"><span class="hs-identifier hs-var">Map.groupBy'</span></a><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Select.html#runSelect"><span class="hs-identifier hs-var">runSelect</span></a><span> </span><a href="#local-6989586621679133439"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">{- |
  Migration Guide: @findRecord@ has been renamed to @findEntity@
-}</span><span>
</span><a name="line-456"></a><span class="hs-identifier">findRecord</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-457"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133376"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133377"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-458"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133378"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133379"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133380"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-459"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133380"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-460"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133377"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679133378"><span class="hs-identifier hs-type">readEntity</span></a><span class="hs-special">)</span><span>
</span><a name="line-461"></a><a name="findRecord"><a href="Database.Orville.PostgreSQL.Core.html#findRecord"><span class="hs-identifier">findRecord</span></a></a><span> </span><a name="local-6989586621679133440"><a href="#local-6989586621679133440"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133441"><a href="#local-6989586621679133441"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-462"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133442"><a href="#local-6989586621679133442"><span class="hs-identifier">keyDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tablePrimaryKey</span><span> </span><a href="#local-6989586621679133440"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-463"></a><span>   </span><span class="hs-keyword">in</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#selectFirst"><span class="hs-identifier hs-var">selectFirst</span></a><span> </span><a href="#local-6989586621679133440"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.SelectOptions.html#where_"><span class="hs-identifier hs-var">where_</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-var">primaryKeyEquals</span></a><span> </span><a href="#local-6989586621679133442"><span class="hs-identifier hs-var">keyDef</span></a><span> </span><a href="#local-6989586621679133441"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span class="hs-comment">{- |
  Migration Guide: @updateFields@ has been renamed to
  @updateFieldsAndReturnRowCount@, but now takes a @NonEmpty SetClause@ instead
  of a @[Field Update]@ and a @Maybe BooleanExpr@ instead of a
  @[WhereCondition]@.

  @updateFields@ still exists as a variant of this function, but returns @()@
  rather than @Int@. @updateFieldsAndReturnEntities@ is now available as well.
-}</span><span>
</span><a name="line-474"></a><span class="hs-identifier">updateFields</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-475"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133371"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133372"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-476"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133373"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133374"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133375"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-477"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FieldUpdate"><span class="hs-identifier hs-type">FieldUpdate</span></a><span class="hs-special">]</span><span>
</span><a name="line-478"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Orville.PostgreSQL.Internal.Where.html#WhereCondition"><span class="hs-identifier hs-type">WhereCondition</span></a><span class="hs-special">]</span><span>
</span><a name="line-479"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133372"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-480"></a><a name="updateFields"><a href="Database.Orville.PostgreSQL.Core.html#updateFields"><span class="hs-identifier">updateFields</span></a></a><span> </span><a name="local-6989586621679133443"><a href="#local-6989586621679133443"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133444"><a href="#local-6989586621679133444"><span class="hs-identifier">updates</span></a></a><span> </span><a name="local-6989586621679133445"><a href="#local-6989586621679133445"><span class="hs-identifier">conds</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-481"></a><span>  </span><a href="Database.Orville.PostgreSQL.Raw.html#updateSql"><span class="hs-identifier hs-var">updateSql</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679133450"><span class="hs-identifier hs-var">updateClause</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679133446"><span class="hs-identifier hs-var">condClause</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679133448"><span class="hs-identifier hs-var">updateValues</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679133447"><span class="hs-identifier hs-var">condValues</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-483"></a><span>    </span><a name="local-6989586621679133446"><a href="#local-6989586621679133446"><span class="hs-identifier">condClause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereClause"><span class="hs-identifier hs-var">whereClause</span></a><span> </span><a href="#local-6989586621679133445"><span class="hs-identifier hs-var">conds</span></a><span>
</span><a name="line-484"></a><span>    </span><a name="local-6989586621679133447"><a href="#local-6989586621679133447"><span class="hs-identifier">condValues</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Where.html#whereValues"><span class="hs-identifier hs-var">whereValues</span></a><span> </span><a href="#local-6989586621679133445"><span class="hs-identifier hs-var">conds</span></a><span>
</span><a name="line-485"></a><span>    </span><a name="local-6989586621679133448"><a href="#local-6989586621679133448"><span class="hs-identifier">updateValues</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">fieldUpdateValue</span><span> </span><a href="#local-6989586621679133444"><span class="hs-identifier hs-var">updates</span></a><span>
</span><a name="line-486"></a><span>    </span><a name="local-6989586621679133449"><a href="#local-6989586621679133449"><span class="hs-identifier">updateNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldUpdate.html#fieldUpdateName"><span class="hs-identifier hs-var">fieldUpdateName</span></a><span> </span><a href="#local-6989586621679133444"><span class="hs-identifier hs-var">updates</span></a><span>
</span><a name="line-487"></a><span>    </span><a name="local-6989586621679133450"><a href="#local-6989586621679133450"><span class="hs-identifier">updateClause</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Sql.html#mkUpdateClause"><span class="hs-identifier hs-var">mkUpdateClause</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">tableName</span><span> </span><a href="#local-6989586621679133443"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679133449"><span class="hs-identifier hs-var">updateNames</span></a><span>
</span><a name="line-488"></a><span>
</span><a name="line-489"></a><span class="hs-comment">{- |
  Migration Guide: @updateRecord@ has been renamed to @updateEntity. Note that
  there are also new variant functions @updateAndReturnEntity@ and
  @updateEntityAndReturnRowCount@.
-}</span><span>
</span><a name="line-494"></a><span class="hs-identifier">updateRecord</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-495"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133366"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133367"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133368"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133369"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133370"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-497"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133370"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-498"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133369"><span class="hs-identifier hs-type">writeEntity</span></a><span>
</span><a name="line-499"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133367"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-500"></a><a name="updateRecord"><a href="Database.Orville.PostgreSQL.Core.html#updateRecord"><span class="hs-identifier">updateRecord</span></a></a><span> </span><a name="local-6989586621679133451"><a href="#local-6989586621679133451"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133452"><a href="#local-6989586621679133452"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679133453"><a href="#local-6989586621679133453"><span class="hs-identifier">record</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-501"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133454"><a href="#local-6989586621679133454"><span class="hs-identifier">keyDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tablePrimaryKey</span><span> </span><a href="#local-6989586621679133451"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-502"></a><span>      </span><a name="local-6989586621679133455"><a href="#local-6989586621679133455"><span class="hs-identifier">conds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-var">primaryKeyEquals</span></a><span> </span><a href="#local-6989586621679133454"><span class="hs-identifier hs-var">keyDef</span></a><span> </span><a href="#local-6989586621679133452"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">]</span><span>
</span><a name="line-503"></a><span>      </span><a name="local-6989586621679133456"><a href="#local-6989586621679133456"><span class="hs-identifier">fields</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.TableDefinition.html#tableAssignableFields"><span class="hs-identifier hs-var">tableAssignableFields</span></a><span> </span><a href="#local-6989586621679133451"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-504"></a><span>      </span><a name="local-6989586621679133457"><a href="#local-6989586621679133457"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tableToSql</span><span> </span><a href="#local-6989586621679133451"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-505"></a><span>      </span><a name="local-6989586621679133458"><a href="#local-6989586621679133458"><span class="hs-identifier">updates</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#FieldUpdate"><span class="hs-identifier hs-var">FieldUpdate</span></a><span> </span><a href="#local-6989586621679133456"><span class="hs-identifier hs-var">fields</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Types.html#runToSql"><span class="hs-identifier hs-var">runToSql</span></a><span> </span><a href="#local-6989586621679133457"><span class="hs-identifier hs-var">builder</span></a><span> </span><a href="#local-6989586621679133453"><span class="hs-identifier hs-var">record</span></a><span class="hs-special">)</span><span>
</span><a name="line-506"></a><span>  </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#updateFields"><span class="hs-identifier hs-var">updateFields</span></a><span> </span><a href="#local-6989586621679133451"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><a href="#local-6989586621679133458"><span class="hs-identifier hs-var">updates</span></a><span> </span><a href="#local-6989586621679133455"><span class="hs-identifier hs-var">conds</span></a><span>
</span><a name="line-507"></a><span>
</span><a name="line-508"></a><span class="hs-comment">{- |
  Migration Guide: @insertRecord@ has been renamed to @insertAndReturnEntity@.
  Note there are also new variant functions @insertEntity@ and
  @insertEntityAndReturnRowCount@ that return @()@ and @Int@ respectively.
-}</span><span>
</span><a name="line-513"></a><span class="hs-identifier">insertRecord</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-514"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133361"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133362"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-515"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133363"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133364"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133365"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-516"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133364"><span class="hs-identifier hs-type">writeEntity</span></a><span>
</span><a name="line-517"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133362"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679133363"><span class="hs-identifier hs-type">readEntity</span></a><span>
</span><a name="line-518"></a><a name="insertRecord"><a href="Database.Orville.PostgreSQL.Core.html#insertRecord"><span class="hs-identifier">insertRecord</span></a></a><span> </span><a name="local-6989586621679133459"><a href="#local-6989586621679133459"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133460"><a href="#local-6989586621679133460"><span class="hs-identifier">newRecord</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-519"></a><span>  </span><a name="local-6989586621679133461"><a href="#local-6989586621679133461"><span class="hs-identifier">results</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#insertRecordManyReturning"><span class="hs-identifier hs-var">insertRecordManyReturning</span></a><span> </span><a href="#local-6989586621679133459"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133460"><span class="hs-identifier hs-var">newRecord</span></a><span class="hs-special">]</span><span>
</span><a name="line-520"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679133461"><span class="hs-identifier hs-var">results</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-521"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679133462"><a href="#local-6989586621679133462"><span class="hs-identifier">entity</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679133462"><span class="hs-identifier hs-var">entity</span></a><span>
</span><a name="line-522"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Didn't get a record back from the database!&quot;</span><span>
</span><a name="line-523"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Got more than one record back from the database!&quot;</span><span>
</span><a name="line-524"></a><span>
</span><a name="line-525"></a><span class="hs-comment">{- |
  Migration Guide: @insertRecordManyReturning@ has been renamed to
  @insertAndReturnEntities@.
-}</span><span>
</span><a name="line-529"></a><span class="hs-identifier">insertRecordManyReturning</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-530"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133356"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133357"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-531"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133358"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133359"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133360"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-532"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133359"><span class="hs-identifier hs-type">writeEntity</span></a><span class="hs-special">]</span><span>
</span><a name="line-533"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133357"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133358"><span class="hs-identifier hs-type">readEntity</span></a><span class="hs-special">]</span><span>
</span><a name="line-534"></a><a name="insertRecordManyReturning"><a href="Database.Orville.PostgreSQL.Core.html#insertRecordManyReturning"><span class="hs-identifier">insertRecordManyReturning</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-535"></a><span class="hs-identifier">insertRecordManyReturning</span><span> </span><a name="local-6989586621679133463"><a href="#local-6989586621679133463"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133464"><a href="#local-6989586621679133464"><span class="hs-identifier">newRecords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-536"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133465"><a href="#local-6989586621679133465"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tableFromSql</span><span> </span><a href="#local-6989586621679133463"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-537"></a><span>      </span><a name="local-6989586621679133466"><a href="#local-6989586621679133466"><span class="hs-identifier">returnSelects</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Expr.Expr.html#expr"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier">fromSqlSelects</span><span> </span><a href="#local-6989586621679133465"><span class="hs-identifier hs-var">builder</span></a><span>
</span><a name="line-538"></a><span>      </span><a name="local-6989586621679133467"><a href="#local-6989586621679133467"><span class="hs-identifier">returnColumns</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-539"></a><span>        </span><span class="hs-identifier hs-var">List.intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Expr.Expr.html#rawExprToSql"><span class="hs-identifier hs-var">rawExprToSql</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Expr.Expr.html#generateSql"><span class="hs-identifier hs-var">generateSql</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679133466"><span class="hs-identifier hs-var">returnSelects</span></a><span>
</span><a name="line-540"></a><span>      </span><a name="local-6989586621679133468"><a href="#local-6989586621679133468"><span class="hs-identifier">insertSql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-541"></a><span>        </span><a href="Database.Orville.PostgreSQL.Internal.Sql.html#mkInsertManyClause"><span class="hs-identifier hs-var">mkInsertManyClause</span></a><span>
</span><a name="line-542"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier">tableName</span><span> </span><a href="#local-6989586621679133463"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span>
</span><a name="line-543"></a><span>          </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.TableDefinition.html#tableAssignableColumnNames"><span class="hs-identifier hs-var">tableAssignableColumnNames</span></a><span> </span><a href="#local-6989586621679133463"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span>
</span><a name="line-544"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679133464"><span class="hs-identifier hs-var">newRecords</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-545"></a><span>        </span><span class="hs-string">&quot; RETURNING &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679133467"><span class="hs-identifier hs-var">returnColumns</span></a><span>
</span><a name="line-546"></a><span>      </span><a name="local-6989586621679133469"><a href="#local-6989586621679133469"><span class="hs-identifier">vals</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Types.html#runToSql"><span class="hs-identifier hs-var">runToSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tableToSql</span><span> </span><a href="#local-6989586621679133463"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679133464"><span class="hs-identifier hs-var">newRecords</span></a><span>
</span><a name="line-547"></a><span>  </span><a name="local-6989586621679133472"><a href="#local-6989586621679133472"><span class="hs-identifier">rows</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-548"></a><span>    </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#withConnection"><span class="hs-identifier hs-var">withConnection</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679133470"><a href="#local-6989586621679133470"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-549"></a><span>      </span><a href="Database.Orville.PostgreSQL.Internal.Execute.html#executingSql"><span class="hs-identifier hs-var">executingSql</span></a><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#InsertQuery"><span class="hs-identifier hs-var">InsertQuery</span></a><span> </span><a href="#local-6989586621679133468"><span class="hs-identifier hs-var">insertSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-550"></a><span>        </span><a name="local-6989586621679133471"><a href="#local-6989586621679133471"><span class="hs-identifier">insert</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">prepare</span><span> </span><a href="#local-6989586621679133470"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="#local-6989586621679133468"><span class="hs-identifier hs-var">insertSql</span></a><span>
</span><a name="line-551"></a><span>        </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">execute</span><span> </span><a href="#local-6989586621679133471"><span class="hs-identifier hs-var">insert</span></a><span> </span><a href="#local-6989586621679133469"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-552"></a><span>        </span><span class="hs-identifier hs-var">fetchAllRowsAL'</span><span> </span><a href="#local-6989586621679133471"><span class="hs-identifier hs-var">insert</span></a><span>
</span><a name="line-553"></a><span>  </span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#decodeSqlRows"><span class="hs-identifier hs-var">decodeSqlRows</span></a><span> </span><a href="#local-6989586621679133465"><span class="hs-identifier hs-var">builder</span></a><span> </span><a href="#local-6989586621679133472"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span class="hs-comment">{- |
  Migration Guide: @insertRecordMany@ has been renamed to @insertEntities@. It
  now requires a @NonEmpty writeEntity@ rather than @[writeEntity]@. Note that
  there are also new variant functions @insertAndReturnEntities@ and
  @insertEntitiesAndReturnRowCount@.
-}</span><span>
</span><a name="line-561"></a><span class="hs-identifier">insertRecordMany</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-562"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133351"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133352"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-563"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133353"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133354"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133355"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-564"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679133354"><span class="hs-identifier hs-type">writeEntity</span></a><span class="hs-special">]</span><span>
</span><a name="line-565"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133352"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-566"></a><a name="insertRecordMany"><a href="Database.Orville.PostgreSQL.Core.html#insertRecordMany"><span class="hs-identifier">insertRecordMany</span></a></a><span> </span><a name="local-6989586621679133473"><a href="#local-6989586621679133473"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133474"><a href="#local-6989586621679133474"><span class="hs-identifier">newRecords</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-567"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133475"><a href="#local-6989586621679133475"><span class="hs-identifier">insertSql</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-568"></a><span>        </span><a href="Database.Orville.PostgreSQL.Internal.Sql.html#mkInsertManyClause"><span class="hs-identifier hs-var">mkInsertManyClause</span></a><span>
</span><a name="line-569"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier">tableName</span><span> </span><a href="#local-6989586621679133473"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span>
</span><a name="line-570"></a><span>          </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.TableDefinition.html#tableAssignableColumnNames"><span class="hs-identifier hs-var">tableAssignableColumnNames</span></a><span> </span><a href="#local-6989586621679133473"><span class="hs-identifier hs-var">tableDef</span></a><span class="hs-special">)</span><span>
</span><a name="line-571"></a><span>          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679133474"><span class="hs-identifier hs-var">newRecords</span></a><span class="hs-special">)</span><span>
</span><a name="line-572"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133476"><a href="#local-6989586621679133476"><span class="hs-identifier">builder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tableToSql</span><span> </span><a href="#local-6989586621679133473"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-573"></a><span>  </span><span class="hs-identifier hs-var">when</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679133474"><span class="hs-identifier hs-var">newRecords</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-574"></a><span>    </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#withConnection"><span class="hs-identifier hs-var">withConnection</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679133477"><a href="#local-6989586621679133477"><span class="hs-identifier">conn</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-575"></a><span>      </span><a href="Database.Orville.PostgreSQL.Internal.Execute.html#executingSql"><span class="hs-identifier hs-var">executingSql</span></a><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#InsertQuery"><span class="hs-identifier hs-var">InsertQuery</span></a><span> </span><a href="#local-6989586621679133475"><span class="hs-identifier hs-var">insertSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-576"></a><span>        </span><a name="local-6989586621679133478"><a href="#local-6989586621679133478"><span class="hs-identifier">insert</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">prepare</span><span> </span><a href="#local-6989586621679133477"><span class="hs-identifier hs-var">conn</span></a><span> </span><a href="#local-6989586621679133475"><span class="hs-identifier hs-var">insertSql</span></a><span>
</span><a name="line-577"></a><span>        </span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">execute</span><span> </span><a href="#local-6989586621679133478"><span class="hs-identifier hs-var">insert</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Types.html#runToSql"><span class="hs-identifier hs-var">runToSql</span></a><span> </span><a href="#local-6989586621679133476"><span class="hs-identifier hs-var">builder</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679133474"><span class="hs-identifier hs-var">newRecords</span></a><span class="hs-special">)</span><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-comment">{- |
  Migration Guide: @deleteRecord@ has been renamed to @deleteEntity@. Note
  that there are also new variant functions @deleteAndReturnEntity@ and
  @deleteEntityAndReturnRowCount@ that return @Maybe readEntity@ and @Int@
  respectively.
-}</span><span>
</span><a name="line-585"></a><span class="hs-identifier">deleteRecord</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-586"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133346"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133347"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-587"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#TableDefinition"><span class="hs-identifier hs-type">TableDefinition</span></a><span> </span><a href="#local-6989586621679133348"><span class="hs-identifier hs-type">readEntity</span></a><span> </span><a href="#local-6989586621679133349"><span class="hs-identifier hs-type">writeEntity</span></a><span> </span><a href="#local-6989586621679133350"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-588"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133350"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-589"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133347"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-590"></a><a name="deleteRecord"><a href="Database.Orville.PostgreSQL.Core.html#deleteRecord"><span class="hs-identifier">deleteRecord</span></a></a><span> </span><a name="local-6989586621679133479"><a href="#local-6989586621679133479"><span class="hs-identifier">tableDef</span></a></a><span> </span><a name="local-6989586621679133480"><a href="#local-6989586621679133480"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-591"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679133481"><a href="#local-6989586621679133481"><span class="hs-identifier">keyDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tablePrimaryKey</span><span> </span><a href="#local-6989586621679133479"><span class="hs-identifier hs-var">tableDef</span></a><span>
</span><a name="line-592"></a><span>  </span><a name="local-6989586621679133482"><a href="#local-6989586621679133482"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Orville.PostgreSQL.Core.html#deleteWhere"><span class="hs-identifier hs-var">deleteWhere</span></a><span> </span><a href="#local-6989586621679133479"><span class="hs-identifier hs-var">tableDef</span></a><span> </span><span class="hs-special">[</span><a href="Database.Orville.PostgreSQL.Internal.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-var">primaryKeyEquals</span></a><span> </span><a href="#local-6989586621679133481"><span class="hs-identifier hs-var">keyDef</span></a><span> </span><a href="#local-6989586621679133480"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">]</span><span>
</span><a name="line-593"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679133482"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-594"></a><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-595"></a><span>         </span><span class="hs-string">&quot;Expected to delete exactly 1 row for deleteRecord\
               \but actually deleted&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-597"></a><span>         </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679133482"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-598"></a><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-identifier">sequenceNextVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-601"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133344"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133345"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-602"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SequenceDefinition"><span class="hs-identifier hs-type">SequenceDefinition</span></a><span>
</span><a name="line-603"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133345"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-604"></a><a name="sequenceNextVal"><a href="Database.Orville.PostgreSQL.Core.html#sequenceNextVal"><span class="hs-identifier">sequenceNextVal</span></a></a><span> </span><a name="local-6989586621679133483"><a href="#local-6989586621679133483"><span class="hs-identifier">seqDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-605"></a><span>  </span><a name="local-6989586621679133484"><a href="#local-6989586621679133484"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Orville.PostgreSQL.Raw.html#selectSql"><span class="hs-identifier hs-var">selectSql</span></a><span> </span><span class="hs-string">&quot;SELECT nextval(?)&quot;</span><span>
</span><a name="line-606"></a><span>                 </span><span class="hs-special">[</span><span class="hs-identifier hs-var">SqlString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sequenceName</span><span> </span><a href="#local-6989586621679133483"><span class="hs-identifier hs-var">seqDef</span></a><span class="hs-special">]</span><span>
</span><a name="line-607"></a><span>                 </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#fieldFromSql"><span class="hs-identifier hs-var">fieldFromSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#int64Field"><span class="hs-identifier hs-var">int64Field</span></a><span> </span><span class="hs-string">&quot;nextval&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-608"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679133484"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-609"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679133485"><a href="#local-6989586621679133485"><span class="hs-identifier">r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679133485"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-610"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Failed to execute nextval for sequence &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sequenceName</span><span> </span><a href="#local-6989586621679133483"><span class="hs-identifier hs-var">seqDef</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;!&quot;</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-identifier">sequenceSetVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-613"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133342"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133343"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-614"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SequenceDefinition"><span class="hs-identifier hs-type">SequenceDefinition</span></a><span>
</span><a name="line-615"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-616"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133343"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-617"></a><a name="sequenceSetVal"><a href="Database.Orville.PostgreSQL.Core.html#sequenceSetVal"><span class="hs-identifier">sequenceSetVal</span></a></a><span> </span><a name="local-6989586621679133486"><a href="#local-6989586621679133486"><span class="hs-identifier">seqDef</span></a></a><span> </span><a name="local-6989586621679133487"><a href="#local-6989586621679133487"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-618"></a><span>  </span><a name="local-6989586621679133488"><a href="#local-6989586621679133488"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Orville.PostgreSQL.Raw.html#selectSql"><span class="hs-identifier hs-var">selectSql</span></a><span> </span><span class="hs-string">&quot;SELECT setval(?, ?)&quot;</span><span>
</span><a name="line-619"></a><span>                 </span><span class="hs-special">[</span><span class="hs-identifier hs-var">SqlString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sequenceName</span><span> </span><a href="#local-6989586621679133486"><span class="hs-identifier hs-var">seqDef</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">SqlInt64</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679133487"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-620"></a><span>                 </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#fieldFromSql"><span class="hs-identifier hs-var">fieldFromSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#int64Field"><span class="hs-identifier hs-var">int64Field</span></a><span> </span><span class="hs-string">&quot;setval&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-621"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679133488"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-622"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679133489"><a href="#local-6989586621679133489"><span class="hs-identifier">r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679133489"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-623"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Failed to execute setval for sequence &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sequenceName</span><span> </span><a href="#local-6989586621679133486"><span class="hs-identifier hs-var">seqDef</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;!&quot;</span><span>
</span><a name="line-624"></a><span>
</span><a name="line-625"></a><span class="hs-identifier">sequenceCurrVal</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-626"></a><span>     </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrville"><span class="hs-identifier hs-type">MonadOrville</span></a><span> </span><a href="#local-6989586621679133340"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679133341"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-627"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Types.html#SequenceDefinition"><span class="hs-identifier hs-type">SequenceDefinition</span></a><span>
</span><a name="line-628"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679133341"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-629"></a><a name="sequenceCurrVal"><a href="Database.Orville.PostgreSQL.Core.html#sequenceCurrVal"><span class="hs-identifier">sequenceCurrVal</span></a></a><span> </span><a name="local-6989586621679133490"><a href="#local-6989586621679133490"><span class="hs-identifier">seqDef</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-630"></a><span>  </span><a name="local-6989586621679133491"><a href="#local-6989586621679133491"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Orville.PostgreSQL.Raw.html#selectSql"><span class="hs-identifier hs-var">selectSql</span></a><span> </span><span class="hs-string">&quot;SELECT currval(?)&quot;</span><span>
</span><a name="line-631"></a><span>                 </span><span class="hs-special">[</span><span class="hs-identifier hs-var">SqlString</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">sequenceName</span><span> </span><a href="#local-6989586621679133490"><span class="hs-identifier hs-var">seqDef</span></a><span class="hs-special">]</span><span>
</span><a name="line-632"></a><span>                 </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.FromSql.html#fieldFromSql"><span class="hs-identifier hs-var">fieldFromSql</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.FieldDefinition.html#int64Field"><span class="hs-identifier hs-var">int64Field</span></a><span> </span><span class="hs-string">&quot;currval&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679133491"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-634"></a><span>    </span><span class="hs-special">[</span><a name="local-6989586621679133492"><a href="#local-6989586621679133492"><span class="hs-identifier">r</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679133492"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-635"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Failed to get current value for sequence &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier">sequenceName</span><span> </span><a href="#local-6989586621679133490"><span class="hs-identifier hs-var">seqDef</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;!&quot;</span><span>
</span><a name="line-636"></a></pre></body></html>