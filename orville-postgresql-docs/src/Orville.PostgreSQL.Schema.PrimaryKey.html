<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{- |
Copyright : Flipstone Technology Partners 2023
License   : MIT
Stability : Stable

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Orville.PostgreSQL.Schema.PrimaryKey</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier">PrimaryKey</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyDescription"><span class="hs-identifier">primaryKeyDescription</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyFieldNames"><span class="hs-identifier">primaryKeyFieldNames</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyToSql"><span class="hs-identifier">primaryKeyToSql</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKey"><span class="hs-identifier">primaryKey</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier">PrimaryKeyPart</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#compositePrimaryKey"><span class="hs-identifier">compositePrimaryKey</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyPart"><span class="hs-identifier">primaryKeyPart</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier">mapPrimaryKeyParts</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mkPrimaryKeyExpr"><span class="hs-identifier">mkPrimaryKeyExpr</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier">primaryKeyEquals</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyIn"><span class="hs-identifier">primaryKeyIn</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Expr.html"><span class="hs-identifier">Orville.PostgreSQL.Expr</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Expr</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.Extra.NonEmpty.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.Extra.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ExtraNonEmpty</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html"><span class="hs-identifier">Orville.PostgreSQL.Marshall.FieldDefinition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier">FieldDefinition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldName.html#FieldName"><span class="hs-identifier">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier">NotNull</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldColumnName"><span class="hs-identifier">fieldColumnName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldEquals"><span class="hs-identifier">fieldEquals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldIn"><span class="hs-identifier">fieldIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldName"><span class="hs-identifier">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldName.html#fieldNameToString"><span class="hs-identifier">fieldNameToString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldValueToSqlValue"><span class="hs-identifier">fieldValueToSqlValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Raw.SqlValue.html"><span class="hs-identifier">Orville.PostgreSQL.Raw.SqlValue</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SqlValue</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="annot"><span class="hs-comment">{- |
  A Haskell description of the 'FieldDefinition's that make up the primary
  key of a SQL table. This type supports composite primary keys as well
  as singular ones.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">data</span><span> </span><span id="PrimaryKey"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-var">PrimaryKey</span></a></span></span><span> </span><span id="local-6989586621679134682"><span class="annot"><a href="#local-6989586621679134682"><span class="hs-identifier hs-type">key</span></a></span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PrimaryKey"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-var">PrimaryKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134682"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134682"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><span class="hs-comment">{- |
  A 'PrimaryKeyPart' describes one field of a composite primary key. Values
  are built using 'primaryKeyPart' and then used with 'compositePrimaryKey'
  to build a 'PrimaryKey'

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">data</span><span> </span><span id="PrimaryKeyPart"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-var">PrimaryKeyPart</span></a></span></span><span> </span><span id="local-6989586621679134683"><span class="annot"><a href="#local-6989586621679134683"><span class="hs-identifier hs-type">key</span></a></span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134740"><span class="annot"><a href="#local-6989586621679134740"><span class="hs-identifier hs-type">part</span></a></span></span><span class="hs-operator">.</span><span> </span><span id="PrimaryKeyPart"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-var">PrimaryKeyPart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134683"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134740"><span class="hs-identifier hs-type">part</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134740"><span class="hs-identifier hs-type">part</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="annot"><span class="hs-comment">{- |
  'primaryKeyDescription' builds a user-readable representation of the
  primary key for use in error messages and such. It is a comma-delimited
  list of the names of the fields that make up the primary key.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-62"></span><span id="local-6989586621679134642"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyDescription"><span class="hs-identifier hs-type">primaryKeyDescription</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134642"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-63"></span><span id="primaryKeyDescription"><span class="annot"><span class="annottext">primaryKeyDescription :: forall key. PrimaryKey key -&gt; String
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyDescription"><span class="hs-identifier hs-var hs-var">primaryKeyDescription</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">List.intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; (PrimaryKey key -&gt; [String]) -&gt; PrimaryKey key -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; String) -&gt; [FieldName] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; String
</span><a href="Orville.PostgreSQL.Internal.FieldName.html#fieldNameToString"><span class="hs-identifier hs-var">fieldNameToString</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">([FieldName] -&gt; [String])
-&gt; (PrimaryKey key -&gt; [FieldName]) -&gt; PrimaryKey key -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty FieldName -&gt; [FieldName]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">(NonEmpty FieldName -&gt; [FieldName])
-&gt; (PrimaryKey key -&gt; NonEmpty FieldName)
-&gt; PrimaryKey key
-&gt; [FieldName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PrimaryKey key -&gt; NonEmpty FieldName
forall key. PrimaryKey key -&gt; NonEmpty FieldName
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyFieldNames"><span class="hs-identifier hs-var">primaryKeyFieldNames</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">{- |
  Retrieves the names of the fields that are part of the primary key.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-74"></span><span id="local-6989586621679134653"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyFieldNames"><span class="hs-identifier hs-type">primaryKeyFieldNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134653"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldName.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span></span><span>
</span><span id="line-75"></span><span id="primaryKeyFieldNames"><span class="annot"><span class="annottext">primaryKeyFieldNames :: forall key. PrimaryKey key -&gt; NonEmpty FieldName
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyFieldNames"><span class="hs-identifier hs-var hs-var">primaryKeyFieldNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679134654"><span id="local-6989586621679134655"><span id="local-6989586621679134657"><span class="annot"><a href="#local-6989586621679134743"><span class="hs-identifier hs-type">partName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134654"><span class="hs-identifier hs-type">part</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134655"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134657"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldName.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span></span></span></span><span>
</span><span id="line-78"></span><span>    </span><span id="local-6989586621679134743"><span class="annot"><span class="annottext">partName :: forall part key a.
(part -&gt; key) -&gt; FieldDefinition NotNull a -&gt; FieldName
</span><a href="#local-6989586621679134743"><span class="hs-identifier hs-var hs-var">partName</span></a></span></span><span> </span><span class="annot"><span class="annottext">part -&gt; key
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679134744"><span class="annot"><span class="annottext">FieldDefinition NotNull a
</span><a href="#local-6989586621679134744"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">FieldDefinition NotNull a -&gt; FieldName
forall nullability a. FieldDefinition nullability a -&gt; FieldName
</span><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull a
</span><a href="#local-6989586621679134744"><span class="hs-identifier hs-var">field</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">(forall part.
 (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; FieldName)
-&gt; PrimaryKey key -&gt; NonEmpty FieldName
forall key a.
(forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a)
-&gt; PrimaryKey key -&gt; NonEmpty a
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier hs-var">mapPrimaryKeyParts</span></a></span><span> </span><span class="annot"><span class="annottext">(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; FieldName
forall part.
(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; FieldName
forall part key a.
(part -&gt; key) -&gt; FieldDefinition NotNull a -&gt; FieldName
</span><a href="#local-6989586621679134743"><span class="hs-identifier hs-var">partName</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">{- |
  'primaryKeyToSql' converts a Haskell value for a primary key into the
  (possibly multiple) sql values that represent the primary key in the
  database.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-90"></span><span id="local-6989586621679134669"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyToSql"><span class="hs-identifier hs-type">primaryKeyToSql</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134669"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134669"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Raw.SqlValue.html#SqlValue"><span class="hs-identifier hs-type">SqlValue.SqlValue</span></a></span></span><span>
</span><span id="line-91"></span><span id="primaryKeyToSql"><span class="annot"><span class="annottext">primaryKeyToSql :: forall key. PrimaryKey key -&gt; key -&gt; NonEmpty SqlValue
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyToSql"><span class="hs-identifier hs-var hs-var">primaryKeyToSql</span></a></span></span><span> </span><span id="local-6989586621679134745"><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134745"><span class="hs-identifier hs-var">keyDef</span></a></span></span><span> </span><span id="local-6989586621679134746"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134746"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">(forall part.
 (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; SqlValue)
-&gt; PrimaryKey key -&gt; NonEmpty SqlValue
forall key a.
(forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a)
-&gt; PrimaryKey key -&gt; NonEmpty a
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier hs-var">mapPrimaryKeyParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key -&gt; (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; SqlValue
forall key part.
key -&gt; (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; SqlValue
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#partSqlValue"><span class="hs-identifier hs-var">partSqlValue</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134746"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134745"><span class="hs-identifier hs-var">keyDef</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><span class="hs-comment">{- |
  'partSqlValue' is an internal helper function that builds the 'SqlValue'
  for one part of a (possible composite) primary key.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679134673"><span id="local-6989586621679134674"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#partSqlValue"><span class="hs-identifier hs-type">partSqlValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679134673"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134673"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134674"><span class="hs-identifier hs-type">part</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134674"><span class="hs-identifier hs-type">part</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Raw.SqlValue.html#SqlValue"><span class="hs-identifier hs-type">SqlValue.SqlValue</span></a></span></span></span><span>
</span><span id="line-101"></span><span id="partSqlValue"><span class="annot"><span class="annottext">partSqlValue :: forall key part.
key -&gt; (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; SqlValue
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#partSqlValue"><span class="hs-identifier hs-var hs-var">partSqlValue</span></a></span></span><span> </span><span id="local-6989586621679134748"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134748"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679134749"><span class="annot"><span class="annottext">key -&gt; part
</span><a href="#local-6989586621679134749"><span class="hs-identifier hs-var">getPart</span></a></span></span><span> </span><span id="local-6989586621679134750"><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134750"><span class="hs-identifier hs-var">partField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="annottext">FieldDefinition NotNull part -&gt; part -&gt; SqlValue
forall nullability a.
FieldDefinition nullability a -&gt; a -&gt; SqlValue
</span><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldValueToSqlValue"><span class="hs-identifier hs-var">fieldValueToSqlValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134750"><span class="hs-identifier hs-var">partField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key -&gt; part
</span><a href="#local-6989586621679134749"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134748"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><span class="hs-comment">{- |
  'primaryKey' constructs a single-field primary key from the 'FieldDefinition'
  that corresponds to the primary key's column. This is generally used while
  building a 'TableDefinition'.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-111"></span><span id="local-6989586621679134679"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKey"><span class="hs-identifier hs-type">primaryKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134679"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134679"><span class="hs-identifier hs-type">key</span></a></span></span><span>
</span><span id="line-112"></span><span id="primaryKey"><span class="annot"><span class="annottext">primaryKey :: forall key. FieldDefinition NotNull key -&gt; PrimaryKey key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKey"><span class="hs-identifier hs-var hs-var">primaryKey</span></a></span></span><span> </span><span id="local-6989586621679134751"><span class="annot"><span class="annottext">FieldDefinition NotNull key
</span><a href="#local-6989586621679134751"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">PrimaryKeyPart key -&gt; [PrimaryKeyPart key] -&gt; PrimaryKey key
forall key.
PrimaryKeyPart key -&gt; [PrimaryKeyPart key] -&gt; PrimaryKey key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-var">PrimaryKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(key -&gt; key) -&gt; FieldDefinition NotNull key -&gt; PrimaryKeyPart key
forall key part.
(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; PrimaryKeyPart key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-var">PrimaryKeyPart</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull key
</span><a href="#local-6989586621679134751"><span class="hs-identifier hs-var">fieldDef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">{- |
  'compositePrimaryKey' constructs a multi-field primary key from the given
  parts, each of which corresponds to one field in the primary key.  You should
  use this while building a 'TableDefinition' for a table that you want to have
  a multi-column primary key. See 'primaryKeyPart' for how to build the parts
  to be passed as parameters. Note: there is no special significance to the
  first argument other than requiring that there is at least one field in the
  primary key.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-126"></span><span id="local-6989586621679134753"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#compositePrimaryKey"><span class="hs-identifier hs-type">compositePrimaryKey</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134753"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134753"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134753"><span class="hs-identifier hs-type">key</span></a></span></span><span>
</span><span id="line-130"></span><span id="compositePrimaryKey"><span class="annot"><span class="annottext">compositePrimaryKey :: forall key.
PrimaryKeyPart key -&gt; [PrimaryKeyPart key] -&gt; PrimaryKey key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#compositePrimaryKey"><span class="hs-identifier hs-var hs-var">compositePrimaryKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">PrimaryKeyPart key -&gt; [PrimaryKeyPart key] -&gt; PrimaryKey key
forall key.
PrimaryKeyPart key -&gt; [PrimaryKeyPart key] -&gt; PrimaryKey key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-var">PrimaryKey</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">{- |
  'primaryKeyPart' constructs a building block for a composite primary key
  based a 'FieldDefinition' and an accessor function to extract the value for
  that field from the Haskell 'key' type that represents the overall composite
  key.  'PrimaryKeyPart' values built using this function are usually then
  passed in a list to 'compositePrimaryKey' to build a 'PrimaryKey'.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679134754"><span id="local-6989586621679134755"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyPart"><span class="hs-identifier hs-type">primaryKeyPart</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134754"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134755"><span class="hs-identifier hs-type">part</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134755"><span class="hs-identifier hs-type">part</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134754"><span class="hs-identifier hs-type">key</span></a></span></span></span><span>
</span><span id="line-146"></span><span id="primaryKeyPart"><span class="annot"><span class="annottext">primaryKeyPart :: forall key part.
(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; PrimaryKeyPart key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyPart"><span class="hs-identifier hs-var hs-var">primaryKeyPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="annottext">(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; PrimaryKeyPart key
forall key part.
(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; PrimaryKeyPart key
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-var">PrimaryKeyPart</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="annot"><span class="hs-comment">{- |
  'mapPrimaryKeyParts' provides a way to access the innards of a 'PrimaryKey'
  definition to extract information. The given function will be called on
  each part of the primary key in order and the list of results is returned.
  Note that single-field and multi-field primary keys are treated the same by
  this function, with the single-field case simply behaving as composite key
  with just one part.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-159"></span><span id="local-6989586621679134666"><span id="local-6989586621679134667"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier hs-type">mapPrimaryKeyParts</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679134665"><span class="annot"><a href="#local-6989586621679134665"><span class="hs-identifier hs-type">part</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134666"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134665"><span class="hs-identifier hs-type">part</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#NotNull"><span class="hs-identifier hs-type">NotNull</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134665"><span class="hs-identifier hs-type">part</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="#local-6989586621679134667"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134666"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679134667"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-167"></span><span id="mapPrimaryKeyParts"><span class="annot"><span class="annottext">mapPrimaryKeyParts :: forall key a.
(forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a)
-&gt; PrimaryKey key -&gt; NonEmpty a
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier hs-var hs-var">mapPrimaryKeyParts</span></a></span></span><span> </span><span id="local-6989586621679134758"><span class="annot"><span class="annottext">forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a
</span><a href="#local-6989586621679134758"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span id="local-6989586621679134759"><span class="annot"><span class="annottext">PrimaryKeyPart key
</span><a href="#local-6989586621679134759"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span id="local-6989586621679134760"><span class="annot"><span class="annottext">[PrimaryKeyPart key]
</span><a href="#local-6989586621679134760"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679134761"><span class="annot"><span class="annottext">doPart :: PrimaryKeyPart key -&gt; a
</span><a href="#local-6989586621679134761"><span class="hs-identifier hs-var hs-var">doPart</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span id="local-6989586621679134762"><span class="annot"><span class="annottext">key -&gt; part
</span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">getPart</span></a></span></span><span> </span><span id="local-6989586621679134763"><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134763"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">(key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a
forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a
</span><a href="#local-6989586621679134758"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; part
</span><a href="#local-6989586621679134762"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134763"><span class="hs-identifier hs-var">field</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="annottext">(PrimaryKeyPart key -&gt; a)
-&gt; NonEmpty (PrimaryKeyPart key) -&gt; NonEmpty a
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyPart key -&gt; a
</span><a href="#local-6989586621679134761"><span class="hs-identifier hs-var">doPart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKeyPart key
</span><a href="#local-6989586621679134759"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyPart key
-&gt; [PrimaryKeyPart key] -&gt; NonEmpty (PrimaryKeyPart key)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[PrimaryKeyPart key]
</span><a href="#local-6989586621679134760"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><span class="hs-comment">{- |
  Builds a 'Expr.PrimaryKeyExpr' that is suitable to be used when creating
  a table to define the primary key on the table.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-180"></span><span id="local-6989586621679134696"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mkPrimaryKeyExpr"><span class="hs-identifier hs-type">mkPrimaryKeyExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134696"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Expr.TableDefinition.html#PrimaryKeyExpr"><span class="hs-identifier hs-type">Expr.PrimaryKeyExpr</span></a></span></span><span>
</span><span id="line-181"></span><span id="mkPrimaryKeyExpr"><span class="annot"><span class="annottext">mkPrimaryKeyExpr :: forall key. PrimaryKey key -&gt; PrimaryKeyExpr
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mkPrimaryKeyExpr"><span class="hs-identifier hs-var hs-var">mkPrimaryKeyExpr</span></a></span></span><span> </span><span id="local-6989586621679134764"><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134764"><span class="hs-identifier hs-var">keyDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679134765"><span class="annot"><span class="annottext">names :: NonEmpty ColumnName
</span><a href="#local-6989586621679134765"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">(forall part.
 (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; ColumnName)
-&gt; PrimaryKey key -&gt; NonEmpty ColumnName
forall key a.
(forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a)
-&gt; PrimaryKey key -&gt; NonEmpty a
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier hs-var">mapPrimaryKeyParts</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">key -&gt; part
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679134766"><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134766"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull part -&gt; ColumnName
forall nullability a. FieldDefinition nullability a -&gt; ColumnName
</span><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldColumnName"><span class="hs-identifier hs-var">fieldColumnName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134766"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134764"><span class="hs-identifier hs-var">keyDef</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">NonEmpty ColumnName -&gt; PrimaryKeyExpr
</span><a href="Orville.PostgreSQL.Expr.TableDefinition.html#primaryKeyExpr"><span class="hs-identifier hs-var">Expr.primaryKeyExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty ColumnName
</span><a href="#local-6989586621679134765"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><span class="hs-comment">{- |
  'primaryKeyEquals' builds a 'Expr.BooleanExpr' that will match the row where
  the primary key is equal to the given value. For single-field primary keys
  this is equivalent to 'fieldEquals', but 'primaryKeyEquals' also handles composite
  primary keys.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-196"></span><span id="local-6989586621679134703"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-type">primaryKeyEquals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134703"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134703"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Expr.WhereClause.html#BooleanExpr"><span class="hs-identifier hs-type">Expr.BooleanExpr</span></a></span></span><span>
</span><span id="line-197"></span><span id="primaryKeyEquals"><span class="annot"><span class="annottext">primaryKeyEquals :: forall key. PrimaryKey key -&gt; key -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-var hs-var">primaryKeyEquals</span></a></span></span><span> </span><span id="local-6989586621679134768"><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134768"><span class="hs-identifier hs-var">keyDef</span></a></span></span><span> </span><span id="local-6989586621679134769"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134769"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="annottext">(BooleanExpr -&gt; BooleanExpr -&gt; BooleanExpr)
-&gt; NonEmpty BooleanExpr -&gt; BooleanExpr
forall a. (a -&gt; a -&gt; a) -&gt; NonEmpty a -&gt; a
</span><a href="Orville.PostgreSQL.Internal.Extra.NonEmpty.html#foldl1%27"><span class="hs-identifier hs-var">ExtraNonEmpty.foldl1'</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">BooleanExpr -&gt; BooleanExpr -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Expr.WhereClause.html#andExpr"><span class="hs-identifier hs-var">Expr.andExpr</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall part.
 (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; BooleanExpr)
-&gt; PrimaryKey key -&gt; NonEmpty BooleanExpr
forall key a.
(forall part. (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; a)
-&gt; PrimaryKey key -&gt; NonEmpty a
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#mapPrimaryKeyParts"><span class="hs-identifier hs-var">mapPrimaryKeyParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key -&gt; (key -&gt; part) -&gt; FieldDefinition NotNull part -&gt; BooleanExpr
forall key a nullability.
key -&gt; (key -&gt; a) -&gt; FieldDefinition nullability a -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#partEquals"><span class="hs-identifier hs-var">partEquals</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134769"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134768"><span class="hs-identifier hs-var">keyDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><span class="hs-comment">{- |
  'primaryKeyIn' builds a 'Expr.BooleanExpr' that will match rows where
  the primary key is contained the given list. For single-field primary keys
  this is equivalent to 'fieldIn', but 'primaryKeyIn' also handles composite
  primary keys.

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-210"></span><span id="local-6989586621679134711"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyIn"><span class="hs-identifier hs-type">primaryKeyIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134711"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="#local-6989586621679134711"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Expr.WhereClause.html#BooleanExpr"><span class="hs-identifier hs-type">Expr.BooleanExpr</span></a></span></span><span>
</span><span id="line-211"></span><span id="primaryKeyIn"><span class="annot"><span class="annottext">primaryKeyIn :: forall key. PrimaryKey key -&gt; NonEmpty key -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyIn"><span class="hs-identifier hs-var hs-var">primaryKeyIn</span></a></span></span><span> </span><span id="local-6989586621679134774"><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134774"><span class="hs-identifier hs-var">keyDef</span></a></span></span><span> </span><span id="local-6989586621679134775"><span class="annot"><span class="annottext">NonEmpty key
</span><a href="#local-6989586621679134775"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134774"><span class="hs-identifier hs-var">keyDef</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#PrimaryKeyPart"><span class="hs-identifier hs-type">PrimaryKeyPart</span></a></span><span> </span><span id="local-6989586621679134777"><span class="annot"><span class="annottext">key -&gt; part
</span><a href="#local-6989586621679134777"><span class="hs-identifier hs-var">getPart</span></a></span></span><span> </span><span id="local-6989586621679134778"><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134778"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><span class="annottext">FieldDefinition NotNull part -&gt; NonEmpty part -&gt; BooleanExpr
forall nullability a.
FieldDefinition nullability a -&gt; NonEmpty a -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldIn"><span class="hs-identifier hs-var">fieldIn</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull part
</span><a href="#local-6989586621679134778"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(key -&gt; part) -&gt; NonEmpty key -&gt; NonEmpty part
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">key -&gt; part
</span><a href="#local-6989586621679134777"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty key
</span><a href="#local-6989586621679134775"><span class="hs-identifier hs-var">keys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">PrimaryKey key
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">(BooleanExpr -&gt; BooleanExpr -&gt; BooleanExpr)
-&gt; NonEmpty BooleanExpr -&gt; BooleanExpr
forall a. (a -&gt; a -&gt; a) -&gt; NonEmpty a -&gt; a
</span><a href="Orville.PostgreSQL.Internal.Extra.NonEmpty.html#foldl1%27"><span class="hs-identifier hs-var">ExtraNonEmpty.foldl1'</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">BooleanExpr -&gt; BooleanExpr -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Expr.WhereClause.html#orExpr"><span class="hs-identifier hs-var">Expr.orExpr</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(key -&gt; BooleanExpr) -&gt; NonEmpty key -&gt; NonEmpty BooleanExpr
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKey key -&gt; key -&gt; BooleanExpr
forall key. PrimaryKey key -&gt; key -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#primaryKeyEquals"><span class="hs-identifier hs-var">primaryKeyEquals</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKey key
</span><a href="#local-6989586621679134774"><span class="hs-identifier hs-var">keyDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty key
</span><a href="#local-6989586621679134775"><span class="hs-identifier hs-var">keys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><span class="hs-comment">{- |
  INTERNAL: builds the where condition for a single part of the key

@since 1.0.0.0
-}</span></span><span>
</span><span id="line-225"></span><span id="local-6989586621679134708"><span id="local-6989586621679134709"><span id="local-6989586621679134710"><span class="annot"><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#partEquals"><span class="hs-identifier hs-type">partEquals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679134708"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679134708"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679134709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134710"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679134709"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Expr.WhereClause.html#BooleanExpr"><span class="hs-identifier hs-type">Expr.BooleanExpr</span></a></span></span></span></span><span>
</span><span id="line-226"></span><span id="partEquals"><span class="annot"><span class="annottext">partEquals :: forall key a nullability.
key -&gt; (key -&gt; a) -&gt; FieldDefinition nullability a -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Schema.PrimaryKey.html#partEquals"><span class="hs-identifier hs-var hs-var">partEquals</span></a></span></span><span> </span><span id="local-6989586621679134780"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134780"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679134781"><span class="annot"><span class="annottext">key -&gt; a
</span><a href="#local-6989586621679134781"><span class="hs-identifier hs-var">getPart</span></a></span></span><span> </span><span id="local-6989586621679134782"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679134782"><span class="hs-identifier hs-var">partField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; a -&gt; BooleanExpr
forall nullability a.
FieldDefinition nullability a -&gt; a -&gt; BooleanExpr
</span><a href="Orville.PostgreSQL.Marshall.FieldDefinition.html#fieldEquals"><span class="hs-identifier hs-var">fieldEquals</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679134782"><span class="hs-identifier hs-var">partField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">key -&gt; a
</span><a href="#local-6989586621679134781"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679134780"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span></pre></body></html>